<!DOCTYPE html>
<html>
  <head>
    <title>Tabela nutricional</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    
    <script>
      function atualizaOption(){
        if($('#option_select').val() == 'calorias'){
          $('#div-outros').hide()
          $('#div-calorias').show()
        }else {
          $('#div-outros').show()
          $('#div-calorias').hide()
        }
      }

      function atualizaTabela(){
        var tipo_busca = document.getElementById('option_select').value
        var rota = ''
        var dados = {}

        if(tipo_busca != 'calorias'){
          rota = document.getElementById('menos-mais').value+'_'+tipo_busca
          dados[tipo_busca] = document.getElementById('valor').value
        }else{
          rota = tipo_busca
          dados.menor_caloria = document.getElementById('valor-mais').value 
          dados.maior_caloria = document.getElementById('valor-menos').value
        }

        var rota_completa = `https://basedealimentosapi-production-12a4.up.railway.app/${rota}`

        $.ajax({
            url: rota_completa,
            method: 'POST', 
            data: dados,
            success: function(response) {
                $('#minha-tabela').html(response);
            },
        });
      }
    </script>

    <style>
      header {
        background-color: rgb(114, 235, 114);
        padding: 5px;
        text-align: center;
      }
  
      img {
        width: 100px;
        height: auto;
      }
    </style>

  </head>
 
  <body> 
    <header>
      <h2 class="text-center">
        <strong>INFORMAÇÕES NUTRICIONAIS</strong>
      </h2>
      <img src="alimentos.png" alt="Logo">
    </header>

    <div class="row d-flex justify-content-center">
      <div class="col-md-10" style="margin-top: 1%">
        <select class="form-control" id="option_select" onchange="atualizaOption()">
          <option value="calorias" selected>Calorias</option>
          <option value="carbo">Carboidrados</option>
          <option value="prot">Proteínas</option>
          <option value="gord">Gorduras</option>
        </select>
      </div>
    </div>

    <div id="div-calorias">
      <div class="row d-flex justify-content-center">
        <div class="col-md-5">
          <label for="valor-mais">Maior caloria:</label>
          <input class="form-control" type="number" id="valor-mais" value="0">
        </div>
        
        <div class="col-md-5">
          <label for="valor-menos">Menor caloria:</label>
          <input class="form-control" type="number" id="valor-menos" value="0">
        </div>
      </div>
    </div>
  
    <div id="div-outros" style="display: none">
      <div class="row d-flex justify-content-center">
        <div class="col-md-5">
          <label for="menos-mais">Pesquisar por:</label>
          <select class="form-control" id="menos-mais">
            <option value="mais">Maior</option>
            <option value="menos">Menor</option>
          </select>
        </div>
        <div class="col-md-5">
          <label for="valor">Valor:</label>
          <input class="form-control" type="number" id="valor" value="0">
        </div>
      </div>
    </div>
      
    <br>
    <div class="text-center">
      <button type="button" onclick="atualizaTabela()" class="btn btn-outline-success">Pesquisar</button>
    </div>

    <div class="row d-flex justify-content-center text-center">
      <div class="col-10" style="margin-top: 4%">
        <hr/>
        <h4> <strong>Alimentos (100g)</strong> </h4>
        <hr/>
        <div id="minha-tabela"></div>
      </div>
    </div> 
  </body>
</html>
